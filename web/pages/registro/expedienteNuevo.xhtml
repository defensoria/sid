<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:gc="http://xmlns.jcp.org/jsf/composite/gc">

    <ui:composition template="../template/template.xhtml">

        <ui:define name="content">
            <h:form id="idForm" class="form-horizontal" enctype="multipart/form-data">
                <h:messages />
                <script>
                    function confirmar2() {
                        if ($("#idTipoClasificacion").val() === "0") {
                            alertar("Debe de ingresar el tipo de expediente!");
                            return false;
                        } else {
                            if ($(".idChecExpedienteOficio").is(':checked')) {
                                if ($("#idTipoClasificacion").val() === "02") {
                                    alertar("Para un expediente de oficio el tipo no puede ser CONSULTA");
                                    return false;
                                }
                            }
                            $(".confirmacion2").modal('show');
                        }

                    }
                    function confirmar3() {
                        if ($("#idTipoClasificacion").val() === "0") {
                            alertar("Debe de ingresar el tipo de expediente!");
                            return false;
                        } else {
                            if ($(".idChecExpedienteOficio").is(':checked')) {
                                if ($("#idTipoClasificacion").val() === "02") {
                                    alertar("Para un expediente de oficio el tipo no puede ser CONSULTA");
                                    return false;
                                }
                            }
                            $(".confirmacion3").modal('show');
                        }
                    }
                    function confirmar0() {

                        $(".confirmacion0").modal('show');

                    }
                </script>
                <gc:confirmSubmit classGC="confirmacion2" bean="#{registroController.guardarVersion()}" mensaje="Está seguro que desea generar una nueva version del expediente?"/>
                <gc:confirmSubmit classGC="confirmacion3" bean="#{registroController.concluir()}" mensaje="Está seguro que desea concluir la etapa?"/>
                <gc:confirmSubmit bean="#{registroController.guardarBorrador()}" />
                <gc:confirmSubmitRemove classGC="confirmacion0" bean="#{registroController.desistirExpediente()}"  mensaje="Está seguro que desea desistir expediente?"/>

                <table style="width: 100%">
                    <tr>
                        <td colspan="2">
                            <div class="panel panel-featured-top-primary">
                                <div class="panel-body" >
                                    <table style="width: 100%">
                                        <tr>
                                            <td>
                                                <span style="font-size: 2em" class="text-resalt-primary">Expediente: #{registroController.expediente.numero}</span>
                                            </td>
                                            <td style="text-align: right">
                                                <a jsf:action="#{registroController.pdf()}">
                                                    <img src="../../bootstrap/img/pdf.png" alt="Plan de Intervencion" height="30" width="30"/>
                                                </a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <h:outputText rendered="#{registroController.etapaEstado.ultimoEstado != null}" value="Estado: #{registroController.etapaEstado.ultimoEstado}" style="font-size: 2em" class="text-resalt-primary"/>
                                            </td>
                                        </tr>    
                                        <tr>
                                            <td colspan="2">
                                                <br/>
                                                <h:panelGroup rendered="#{registroController.expediente.tipoClasificion == '01'}">
                                                    <table style="width: 90%">
                                                        <tr>
                                                            <td style="width: 10%">
                                                                <span style="font-size: 2em" class="text-resalt-primary">Etapa:</span>
                                                            </td>
                                                            <td>
                                                                <div class="btn-group btn-group-justified" role="group" style="width: 80%">
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(1)}" class="btn #{registroController.etapaEstado.verEtapa == 1? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 1}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Calificación
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Calificación
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(2)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 2? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 2}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Investigación
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Investigación
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(3)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 3? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 3}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Persuasión
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Persuasión
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(1)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 4? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 4}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Seguimiento
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Seguimiento
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                                <table style="width: 80%">
                                                                    <tr>
                                                                        <td style="width: 25%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 1}" style="color: #878787" value="Quedan 4 días para culminar la etapa de Calificación"/>
                                                                        </td>
                                                                        <td style="width: 25%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 2}" style="color: #878787" value="Quedan 80 días para culminar la etapa de Investigación"/>
                                                                        </td>
                                                                        <td style="width: 25%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 3}" style="color: #878787" value="Quedan 40 días para culminar la etapa de Persuasión"/>
                                                                        </td>
                                                                        <td style="width: 25%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 4}" style="color: #878787" value="Quedan 60 días para culminar la etapa de Seguimiento"/>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </h:panelGroup>

                                                <h:panelGroup rendered="#{registroController.expediente.tipoClasificion == '03'}">
                                                    <table style="width: 90%">
                                                        <tr>
                                                            <td style="width: 10%">
                                                                <span style="font-size: 2em" class="text-resalt-primary">Etapa:</span>
                                                            </td>
                                                            <td>
                                                                <div class="btn-group btn-group-justified" role="group" style="width: 80%">
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(1)}" class="btn #{registroController.etapaEstado.verEtapa == 5? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 1}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Calificación
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Calificación
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(2)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 6? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 2}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Gestión
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Gestión
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                    <div class="btn-group" role="group">
                                                                        <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(3)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 7? 'btn-warning' : 'btn-default'}">
                                                                            <c:choose>
                                                                                <c:when test="${registroController.etapaEstado.verEtapa == 3}">
                                                                                    <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Persuasión
                                                                                </c:when>
                                                                                <c:otherwise>
                                                                                    Persuasión
                                                                                </c:otherwise>
                                                                            </c:choose>
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                                <table style="width: 80%">
                                                                    <tr>
                                                                        <td style="width: 33%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 5}" style="color: #878787" value="Quedan 4 días para culminar la etapa de Calificación"/>
                                                                        </td>
                                                                        <td style="width: 33%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 6}" style="color: #878787" value="Quedan 30 días para culminar la etapa de Gestión"/>
                                                                        </td>
                                                                        <td style="width: 33%">
                                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa == 7}" style="color: #878787" value="Quedan 30 días para culminar la etapa de Persuasión"/>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </h:panelGroup>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <table style="width: 90%">
                                                    <tr>
                                                        <td style="width: 25%; ">
                                                            <h:outputText rendered="#{registroController.etapaEstado.verEtapa != 0 and registroController.etapaEstado.verEtapa != null}" value="Asignar estado:" class="text-primary" style="font-size: 1.5em"/>
                                                        </td>
                                                        <td>
                                                            <div class="panel-body">
                                                                <h:panelGroup id="idPanelEstado">
                                                                    <table style="width: 90%">
                                                                        <tr>
                                                                            <td style="padding-right: 10px; width: 70%;">
                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 1}"  value="#{registroController.expediente.estadoCalificacion}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoCalificacionQueja}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>

                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 2}"  value="#{registroController.expediente.estadoInvestigacion}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoInvestigacionQueja}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>

                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 3}"  value="#{registroController.expediente.estadoPersuacion}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoPersuacionQueja}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>

                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 4}"  value="#{registroController.expediente.estadoSeguimiento}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoSeguimientoQueja}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>
                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 5}"  value="#{registroController.expediente.estadoCalificacion}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoCalificacionPetitorio}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>

                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 6}"  value="#{registroController.expediente.estadoGestion}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoGestionPetitorio}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>            

                                                                                <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 7}"  value="#{registroController.expediente.estadoPersuacion}">
                                                                                    <f:selectItems value="#{registroController.listaEstadoPersuacionPetitorio}"  />
                                                                                    <f:ajax render="idPanelEstado" execute="@form"/>
                                                                                </h:selectOneRadio>            



                                                                            </td>
                                                                            <td style="vertical-align: top">
                                                                                <textarea rows="3" jsf:rendered="#{registroController.expediente.estadoCalificacion != null and registroController.etapaEstado.verEtapa == 1}" style="width: 100%" placeholder="Justificación"/>
                                                                                <textarea rows="3" jsf:rendered="#{registroController.expediente.estadoInvestigacion != null and registroController.etapaEstado.verEtapa == 2}" style="width: 100%" placeholder="Justificación"/>
                                                                                <textarea rows="3" jsf:rendered="#{registroController.expediente.estadoPersuacion != null and registroController.etapaEstado.verEtapa == 3}" style="width: 100%" placeholder="Justificación"/>
                                                                                <textarea rows="3" jsf:rendered="#{registroController.expediente.estadoSeguimiento != null and registroController.etapaEstado.verEtapa == 4}" style="width: 100%" placeholder="Justificación"/>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </h:panelGroup>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <script>

                                                                function modalAsignar(data) {
                                                                    if (data.status === 'success') {
                                                                        $("#loadModal").modal('hide');
                                                                        $('body').removeClass('modal-open');
                                                                        $(".modal-backdrop").removeClass("modal-backdrop");
                                                                        $("#idModalAsignar").modal('show');
                                                                    }
                                                                }
                                                            </script>
                                                            <h:panelGroup rendered="#{(registroController.etapaEstado.verEtapa == 1 or registroController.etapaEstado.verEtapa == 5) and seguridadUtilController.tieneRecurso('REC_EXP007') and registroController.expediente.codigoOD == registroController.usuarioSession.codigoOD}">
                                                                <a class="btn btn-warning" jsf:action="#{registroController.limpiarModalAsignar()}" jsf:onclick="loadingModal()">
                                                                    <span class="glyphicon glyphicon-user" />Asignar Expediente
                                                                    <f:ajax render="idPanelAsignar" onevent="modalAsignar" />
                                                                </a>
                                                            </h:panelGroup>
                                                            <h:panelGroup id="idPanelAsignar">
                                                                <div class="modal fade" data-backdrop="static" data-keyboard="false" id="idModalAsignar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                    <div class="modal-dialog" style="text-align: left">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <a type="button" class="close" data-dismiss="modal">
                                                                                    <span style="color:red" class="glyphicon glyphicon-remove"></span>
                                                                                </a>
                                                                                <span class="text-resalt-primary">Asignar expediente</span>
                                                                            </div>
                                                                            <div class="modal-body" style="padding:5px">

                                                                                <span class="text-bold">Seleccione Comisionado:</span>
                                                                                <h:selectOneMenu value="#{registroController.expediente.usuarioAsignado}">
                                                                                    <f:selectItems value="#{registroController.listaUsuarioOD}" var="item" itemLabel="#{item.nombre} #{item.apellidoPaterno} #{item.apellidoMaterno}" itemValue="#{item.codigo}" />
                                                                                </h:selectOneMenu>
                                                                                <div class="modal-footer">
                                                                                    <a  class="btn btn-default" data-dismiss="modal">
                                                                                        <span class="glyphicon glyphicon-remove"/>Cerrar
                                                                                    </a>
                                                                                    <a class="btn btn-primary" data-dismiss="modal" jsf:action="#{registroController.guardarAsignado()}">
                                                                                        <span class="glyphicon glyphicon-floppy-disk"/>Guardar
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </h:panelGroup>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <table style="width: 90%">
                                                    <tr>
                                                        <td style="width: 50%">

                                                            <div  class="alert fade in" role="alert" style="width: 100%;text-align:right;border:solid silver 1px;background:white;color:silver;padding-bottom:5px;padding-top:5px;margin-bottom:3px">
                                                                <input type="hidden" id="idTipoClasificacion" jsf:value="#{registroController.expediente.tipoClasificion}" />

                                                                <span id="idTextTipoClasificacion" class="text-primary" style="float: left; font-weight: bold;">Seleccione</span>
                                                                <h:panelGroup rendered="#{registroController.etapaEstado.verEtapa == 0 or registroController.etapaEstado.verEtapa == null or registroController.expediente.version == 0}">
                                                                    <a href="#" class="trigger2">
                                                                        <span style="color:#3183b9;font-size:large;vertical-align: top" class="glyphicon glyphicon-chevron-down trigger2"></span>
                                                                    </a>
                                                                </h:panelGroup>
                                                                <h:panelGroup  rendered="#{registroController.etapaEstado.verEtapa != 0 and registroController.etapaEstado.verEtapa != null}">
                                                                    <a class="trigger2">
                                                                        <span style="color:#3183b9;font-size:large;vertical-align: top" class="glyphicon glyphicon-chevron-down trigger2"></span>
                                                                    </a>
                                                                </h:panelGroup>

                                                                <div class="popover-markup" style="float:left">
                                                                    <div class="head hide">
                                                                        <b class="text-primary">Seleccione</b>
                                                                    </div>
                                                                    <div class="content hide">
                                                                        <div style="width:100%">
                                                                            <c:forEach var="x" items="#{listasComunesController.buscarExpedienteTipoClasificacion(false,false,false)}">
                                                                                <a class="alink" onclick="asignarTipo('${x.valorParametro}')">
                                                                                    <div class="alert fade in alert-warning" role="alert" style="padding-bottom:5px;padding-top:5px;margin-bottom:3px">
                                                                                        <h:outputText value="${x.nombreParametro}" style="cursor:pointer"/>
                                                                                    </div>
                                                                                </a>
                                                                            </c:forEach>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <style>.alink:hover{text-decoration:none}.alink:link{text-decoration:none}.alink:active{text-decoration:none}</style>
                                                                <script>$('.trigger2').popover({html: true, placement: 'bottom', tabindex: '0', trigger: 'focus', title: function () {
                                                                            return $(this).parent().find('.head').html();
                                                                        }, content: function () {
                                                                            return $(this).parent().find('.content').html();
                                                                        }});
                                                                    function asignarTipo(tipo) {
                                                                        $("#idTipoClasificacion").val(tipo);
                                                                        $("#idTextTipoClasificacion").css("color", "#3071A9");
                                                                        if (tipo === "01") {
                                                                            $("#idTextTipoClasificacion").text("QUEJA");

                                                                        }
                                                                        if (tipo === "02") {
                                                                            $("#idTextTipoClasificacion").text("CONSULTA");

                                                                        }
                                                                        if (tipo === "03") {
                                                                            $("#idTextTipoClasificacion").text("PETITORIO");

                                                                        }
                                                                        if (tipo === "04") {
                                                                            $("#idTextTipoClasificacion").text("SIN CLASIFICACION");

                                                                        }
                                                                    }
                                                                    if ($("#idTipoRegistro").val() !== "") {
                                                                        if ($("#idTipoClasificacion").val() === "01") {
                                                                            $("#idTextTipoClasificacion").text("QUEJA");

                                                                        }
                                                                        if ($("#idTipoClasificacion").val() === "02") {
                                                                            $("#idTextTipoClasificacion").text("CONSULTA");

                                                                        }
                                                                        if ($("#idTipoClasificacion").val() === "03") {
                                                                            $("#idTextTipoClasificacion").text("PETITORIO");

                                                                        }
                                                                        if ($("#idTipoClasificacion").val() === "04") {
                                                                            $("#idTextTipoClasificacion").text("SIN CLASIFICACION");

                                                                        }
                                                                        $("#idTextTipoClasificacion").css("color", "#3071A9");
                                                                    }
                                                                    $(document).ready(function () {
                                                                        if ($("#idTipoRegistro").val() !== "") {
                                                                            if ($("#idTipoClasificacion").val() === "01") {
                                                                                $("#idTextTipoClasificacion").text("QUEJA");

                                                                            }
                                                                            if ($("#idTipoClasificacion").val() === "02") {
                                                                                $("#idTextTipoClasificacion").text("CONSULTA");

                                                                            }
                                                                            if ($("#idTipoClasificacion").val() === "03") {
                                                                                $("#idTextTipoClasificacion").text("PETITORIO");

                                                                            }
                                                                            if ($("#idTipoClasificacion").val() === "04") {
                                                                                $("#idTextTipoClasificacion").text("SIN CLASIFICACION");

                                                                            }
                                                                            $("#idTextTipoClasificacion").css("color", "#3071A9");
                                                                        }
                                                                    });</script>
                                                            </div>
                                                        </td>
                                                        <td style="text-align: right">
                                                            <script>
                                                                function confirmarBorrador() {
                                                                    if ($("#idTipoClasificacion").val() === "0") {
                                                                        alertar("Debe de ingresar el tipo de expediente!");
                                                                        return false;
                                                                    } else {
                                                                        confirmar();
                                                                    }
                                                                }
                                                            </script>
                                                            <h:panelGroup  id="idPanel3" rendered="#{registroController.expediente.id == null || registroController.expediente.version == 0}">
                                                                <a class="btn btn-info" onclick="confirmarBorrador()">
                                                                    <span class="glyphicon glyphicon-floppy-disk" />Borrador
                                                                </a>
                                                            </h:panelGroup>
                                                            &#160;&#160;
                                                            <h:panelGroup rendered="#{registroController.expediente.general != 'C' and registroController.verBotonRegistrarExpediente and registroController.expediente.usuarioRegistro == registroController.usuarioSession.codigo}">
                                                                <a class="btn btn-primary" onclick="confirmar2()">
                                                                    <span class="glyphicon glyphicon-floppy-disk" />Guardar
                                                                </a>
                                                            </h:panelGroup>
                                                            &#160;&#160;
                                                            <h:panelGroup id="idPanel2" rendered="#{registroController.expediente.id != null and registroController.expediente.version > 0 and registroController.expediente.general != 'C' and registroController.verBotonRegistrarExpediente and registroController.expediente.usuarioRegistro == registroController.usuarioSession.codigo}">
                                                                <a class="btn btn-warning" onclick="confirmar3()">
                                                                    <span class="glyphicon glyphicon-floppy-save" />Concluir Etapa
                                                                </a>
                                                            </h:panelGroup>
                                                            &#160;&#160;
                                                            <a class="btn btn-info">
                                                                <span class="glyphicon glyphicon-link" />Mayor información
                                                            </a>
                                                            &#160;&#160;
                                                            <h:panelGroup rendered="#{registroController.expediente.id != null and registroController.expediente.version > 0 and registroController.expediente.general != 'C' and registroController.verBotonRegistrarExpediente and registroController.expediente.usuarioRegistro == registroController.usuarioSession.codigo}">
                                                                <a class="btn btn-danger" onclick="confirmar0()" >
                                                                    <span class="glyphicon glyphicon-remove" />Desistir
                                                                </a>
                                                            </h:panelGroup>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>

                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
                <ul class="nav nav-tabs">
                    <li role="presentation" class="active">
                        <a style="cursor: pointer" jsf:action="#{registroController.datosGeneralesExpediente()}">
                            <span style="font-size: large; color: #007ACC; font-weight: bold" class="glyphicon glyphicon-list-alt" > Datos generales</span>
                        </a>
                    </li>
                    <li role="presentation">
                        <a style="cursor: pointer" jsf:rendered="#{registroController.etapaEstado.idEtapa > 0}" jsf:action="#{registroController.cargarExpedienteGestionLista()}">
                            <span style="font-size: medium; color: purple" class="glyphicon glyphicon-list-alt" > Gestiones externas</span>
                        </a>
                    </li>
                    <li role="presentation">
                        <a style="cursor: pointer" jsf:rendered="#{registroController.etapaEstado.idEtapa > 0}" jsf:action="#{registroController.inicioAcciones()}">
                            <span style="font-size: medium; color: purple" class="glyphicon glyphicon-list-alt" > Gestiones internas</span>
                        </a>
                    </li>
                </ul>

                <div class="panel panel-default">
                    <div class="panel-body">
                        <table style="width: 100%">
                            <tr>
                                <td style="width: 50%; vertical-align: top; padding-right: 2px">
                                    <div class="panel panel-featured-top-silver" id="idPanel1">
                                        <div class="panel-body" >
                                            <span class="text-resalt-primary">Información de ingreso</span>
                                            <br/><br/>
                                            <table style="width: 100%">
                                                <tr>
                                                    <td style="padding-bottom: 10px; width: 40%">
                                                        <span class="text-bold">Fecha de Ingreso:</span>
                                                    </td>
                                                    <td style="padding-bottom: 10px">
                                                        <gc:calendar value="#{registroController.expediente.fechaIngreso}" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 10px">
                                                        <span class="text-bold">Canal de ingreso:</span>
                                                    </td>
                                                    <td style="padding-bottom: 10px">
                                                        <h:selectOneMenu value="#{registroController.expediente.tipoIngreso}">
                                                            <f:selectItem itemValue="0" itemLabel="Seleccione" />
                                                            <f:selectItems value="#{listasComunesController.buscarExpedienteTipoIngreso(false,false,false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                        </h:selectOneMenu>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <span class="text-bold">Expediente de oficio:</span>
                                                    </td>
                                                    <td>
                                                        <h:selectBooleanCheckbox class="idChecExpedienteOficio" value="#{registroController.expediente.indicadorOficio}" style="background: #EEEEEE; pointer-events:none;"/>
                                                    </td>
                                                </tr>
                                            </table>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <h:panelGroup id="idPanelClasificacionTem">
                                                <table style="width: 100%">
                                                    <tr>
                                                        <td>
                                                            <span class="text-resalt-primary">Clasificación temática</span>
                                                        </td>
                                                        <td style="text-align: right">
                                                            <h:panelGroup rendered="#{registroController.expediente.numero != null}">
                                                                <a jsf:action="#{registroController.guardarNivel()}" jsf:onclick="loadingModal()">
                                                                    <span class="glyphicon glyphicon-plus" style="font-size: 1.3em" />Agregar/Actualizar clasificación
                                                                    <f:ajax render="idPanelClasificacionTem" execute="idPanelClasificacionTem" onevent="closeModal"/>
                                                                </a>
                                                            </h:panelGroup>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <br/><br/>

                                                <script>
                                                    $(function () {
                                                    #{registroController.cadenaEtiquetaAutocomplete}
                                                        $("#etiqueta").autocomplete({
                                                            minLength: 3,
                                                            source: projects,
                                                            focus: function (event, ui) {
                                                                $("#etiqueta").val(ui.item.label);
                                                                return false;
                                                            },
                                                            select: function (event, ui) {
                                                                $("#etiqueta").val(ui.item.label);
                                                                $("#idEtiqueta").val(ui.item.value);

                                                                return false;
                                                            }
                                                        })
                                                                .data("ui-autocomplete")._renderItem = function (ul, item) {
                                                            return $("<li/>")
                                                                    .append("<a>" + item.label + "<br/>" + item.desc + "</a>")
                                                                    .appendTo(ul);
                                                        };

                                                    });
                                                </script>
                                                <table style="width: 100%">
                                                    <tr>
                                                        <td style="padding-bottom: 10px" colspan="2">
                                                            <span class="text-bold" style="font-size: 1.2em; color: red">Ambito</span>
                                                        </td>
                                                    </tr> 
                                                    <tr>
                                                        <td style="width: 40%; padding-bottom: 10px">
                                                            <span class="text-bold">Ambito:</span>
                                                        </td>
                                                        <td style="padding-bottom: 10px">
                                                            <table style="width: 100%">
                                                                <tr>
                                                                    <td>

                                                                    </td>
                                                                    <td>
                                                                        <a jsf:rendered="#{registroController.expediente.numero != null}" style="cursor: pointer" jsf:action="#{registroController.limpiarModalBusquedaClasificacion()}" jsf:onclick="loadingModal()">
                                                                            <span class="glyphicon glyphicon-search" style="font-size: large" />
                                                                            <f:ajax render="@form" onevent="openModalBusquedaClasificacion" />
                                                                        </a>
                                                                        <script>
                                                                            function openModalBusquedaClasificacion(data) {
                                                                                if (data.status === 'success') {
                                                                                    $("#loadModal").modal('hide');
                                                                                    $('body').removeClass('modal-open');
                                                                                    $(".modal-backdrop").removeClass("modal-backdrop");
                                                                                    $("#idModalBusquedaClasificacion").modal('show');
                                                                                }
                                                                            }
                                                                        </script>
                                                                        <div class="modal fade" data-backdrop="static" data-keyboard="false" id="idModalBusquedaClasificacion" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                            <div class="modal-dialog" style="text-align: left">
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <a type="button" class="close" data-dismiss="modal">
                                                                                            <span style="color:red" class="glyphicon glyphicon-remove"></span>
                                                                                        </a>
                                                                                        <span class="text-resalt-primary">Búsqueda de clasificación</span>
                                                                                    </div>
                                                                                    <div class="modal-body" style="padding:5px">
                                                                                        <div class="panel-body">

                                                                                            <table style="width: 100%">
                                                                                                <tr>
                                                                                                    <td>
                                                                                                        <input type="text" autocomplete="off" jsf:value="#{registroController.expedienteClasificacionBusqueda.nombre}" maxlength="100" />
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        <a class="btn btn-primary" jsf:action="#{registroController.buscarClasificacion(1)}">
                                                                                                            <span class="glyphicon glyphicon-search" />
                                                                                                            <f:ajax render="idPanelBusquedaClasificacion" execute="@form" />Buscar
                                                                                                        </a>
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </table>
                                                                                            <br/>
                                                                                            <h:panelGroup id="idPanelBusquedaClasificacion">
                                                                                                <c:forEach var="nivel" items="#{registroController.listaExpedienteNivelModal}">
                                                                                                    <div class="alert alert-warning fade in" style="margin-bottom: 3px">
                                                                                                        <table style="width: 100%">
                                                                                                            <tr>
                                                                                                                <td>
                                                                                                                    <h:outputText style="font-weight: bold" value="#{nivel.primerNivel}"/>
                                                                                                                    <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.segundoNivel != null}"/>
                                                                                                                    <h:outputText style="font-weight: bold" value="#{nivel.segundoNivel}" />
                                                                                                                    <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.tercerNivel != null}"/>
                                                                                                                    <h:outputText style="font-weight: bold" value="#{nivel.tercerNivel}" />
                                                                                                                    <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.cuartoNivel != null}"/>
                                                                                                                    <h:outputText style="font-weight: bold" value="#{nivel.cuartoNivel}" />
                                                                                                                    <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.quintoNivel != null}"/>
                                                                                                                    <h:outputText style="font-weight: bold" value="#{nivel.quintoNivel}" />
                                                                                                                    <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.sextoNivel != null}"/>
                                                                                                                    <h:outputText style="font-weight: bold" value="#{nivel.sextoNivel}" />
                                                                                                                </td>
                                                                                                                <td>
                                                                                                                    <a jsf:action="#{registroController.guardarNivel(nivel)}" jsf:onclick="loadingModal()">
                                                                                                                        <span class="glyphicon glyphicon-check"  style="color: #007ACC; font-size: medium"/>
                                                                                                                        <f:ajax render="@form" onevent="closeModal" />
                                                                                                                    </a>
                                                                                                                </td>
                                                                                                            </tr>
                                                                                                        </table>    
                                                                                                    </div>             
                                                                                                </c:forEach>
                                                                                                <br/>
                                                                                                <ul class="pager">
                                                                                                    <li>
                                                                                                        <a jsf:action="#{registroController.buscarClasificacion(registroController.nroPaginaModal -1)}" jsf:rendered="#{!empty registroController.listaExpedienteNivelModal}" jsf:onclick="loadingModal()">Anterior
                                                                                                            <f:ajax render="idPanelBusquedaClasificacion" onevent="closeModal"/>
                                                                                                        </a>
                                                                                                    </li>
                                                                                                    <li>
                                                                                                        <a jsf:action="#{registroController.buscarClasificacion(registroController.nroPaginaModal +1)}" jsf:rendered="#{!empty registroController.listaExpedienteNivelModal}" jsf:onclick="loadingModal()">Siguiente
                                                                                                            <f:ajax render="idPanelBusquedaClasificacion" onevent="closeModal"/>
                                                                                                        </a>
                                                                                                    </li>
                                                                                                </ul>

                                                                                            </h:panelGroup>
                                                                                        </div>
                                                                                        <div class="modal-footer">
                                                                                            <a  class="btn btn-default" data-dismiss="modal">
                                                                                                <span class="glyphicon glyphicon-remove"/>Cerrar
                                                                                            </a>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="padding-bottom: 10px">
                                                            <span class="text-bold">Tema:</span>
                                                        </td>
                                                        <td style="padding-bottom: 10px">
                                                            <h:selectOneMenu value="#{registroController.expedienteNivel.idPrimerNivel}" onchange="loadingModal()">
                                                                <f:selectItems value="#{registroController.listaClasificacionPrimerLevel}" />
                                                                <f:ajax listener="#{registroController.cargarNivelesClasificacion(registroController.expedienteNivel.idPrimerNivel, 2)}" 
                                                                        render="idSelectSegundoNivel idSelectTercerNivel idSelectCuartoNivel idSelectQuintoNivel idSelectSextoNivel" onevent="closeModal"/>
                                                            </h:selectOneMenu>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="padding-bottom: 10px">
                                                            <span class="text-bold">Sub tema:</span>
                                                        </td>
                                                        <td style="padding-bottom: 10px">
                                                            <h:selectOneMenu id="idSelectSegundoNivel" value="#{registroController.expedienteNivel.idSegundoNivel}" onchange="loadingModal()">
                                                                <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                                <f:selectItems value="#{registroController.listaClasificacionSegundoLevel}" />
                                                                <f:ajax listener="#{registroController.cargarNivelesClasificacion(registroController.expedienteNivel.idSegundoNivel, 3)}"  
                                                                        render="idSelectTercerNivel idSelectCuartoNivel idSelectQuintoNivel idSelectSextoNivel" onevent="closeModal"/>
                                                            </h:selectOneMenu>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="padding-bottom: 10px">
                                                            <span class="text-bold">Tercer nivel:</span>
                                                        </td>
                                                        <td style="padding-bottom: 10px">
                                                            <h:selectOneMenu id="idSelectTercerNivel" value="#{registroController.expedienteNivel.idTercerNivel}" onchange="loadingModal()">
                                                                <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                                <f:selectItems value="#{registroController.listaClasificacionTercerLevel}" />
                                                                <f:ajax listener="#{registroController.cargarNivelesClasificacion(registroController.expedienteNivel.idTercerNivel, 4)}" 
                                                                        render="idSelectCuartoNivel idSelectQuintoNivel idSelectSextoNivel" onevent="closeModal"/>
                                                            </h:selectOneMenu>
                                                        </td>
                                                    </tr>

                                                    <tr>
                                                        <td style="padding-bottom: 10px">
                                                            <span class="text-bold">Cuarto nivel:</span>
                                                        </td>
                                                        <td style="padding-bottom: 10px">
                                                            <h:selectOneMenu id="idSelectCuartoNivel" value="#{registroController.expedienteNivel.idCuartoNivel}" onchange="loadingModal()">
                                                                <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                                <f:selectItems value="#{registroController.listaClasificacionCuartoLevel}" />
                                                                <f:ajax listener="#{registroController.cargarNivelesClasificacion(registroController.expedienteNivel.idCuartoNivel, 5)}" 
                                                                        render="idSelectQuintoNivel idSelectSextoNivel" onevent="closeModal"/>
                                                            </h:selectOneMenu>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="padding-bottom: 20px">
                                                            <span class="text-bold">Quinto nivel:</span>
                                                        </td>
                                                        <td style="padding-bottom: 20px">
                                                            <h:selectOneMenu id="idSelectQuintoNivel" value="#{registroController.expedienteNivel.idQuintoNivel}" onchange="loadingModal()">
                                                                <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                                <f:selectItems value="#{registroController.listaClasificacionQuintoLevel}" />
                                                                <f:ajax listener="#{registroController.cargarNivelesClasificacion(registroController.expedienteNivel.idQuintoNivel, 6)}" 
                                                                        render="idSelectSextoNivel" onevent="closeModal"/>
                                                            </h:selectOneMenu>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="padding-bottom: 20px">
                                                            <span class="text-bold">Sexto nivel:</span>
                                                        </td>
                                                        <td style="padding-bottom: 20px">
                                                            <h:selectOneMenu id="idSelectSextoNivel" value="#{registroController.expedienteNivel.idSextoNivel}">
                                                                <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                                <f:selectItems value="#{registroController.listaClasificacionSextoLevel}" />
                                                            </h:selectOneMenu>
                                                        </td>
                                                    </tr>

                                                    <tr>
                                                        <td style="padding-bottom: 20px; vertical-align: top">
                                                            <span class="text-bold">Clasificación:</span>
                                                        </td>
                                                        <td style="padding-bottom: 20px">
                                                            <c:forEach var="nivel" items="#{registroController.expediente.listaExpedienteNivel}">
                                                                <div class="alert alert-warning fade in" style="margin-bottom: 3px">
                                                                    <table style="width: 100%">
                                                                        <tr>
                                                                            <td style="width: 90%">
                                                                                <h:outputText style="font-weight: bold" value="#{nivel.primerNivel}"/>
                                                                                <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.segundoNivel != null}"/>
                                                                                <h:outputText style="font-weight: bold" value="#{nivel.segundoNivel}" />
                                                                                <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.tercerNivel != null}"/>
                                                                                <h:outputText style="font-weight: bold" value="#{nivel.tercerNivel}" />
                                                                                <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.cuartoNivel != null}"/>
                                                                                <h:outputText style="font-weight: bold" value="#{nivel.cuartoNivel}" />
                                                                                <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.quintoNivel != null}"/>
                                                                                <h:outputText style="font-weight: bold" value="#{nivel.quintoNivel}" />
                                                                                <h:outputText style="color: gray; font-weight: bold;" value=" > " rendered="#{nivel.sextoNivel != null}"/>
                                                                                <h:outputText style="font-weight: bold" value="#{nivel.sextoNivel}" />
                                                                            </td>
                                                                            <td>
                                                                                <a onclick="confirmar4#{nivel.id}()">
                                                                                    <span class="glyphicon glyphicon-remove"  style="color: red"/>
                                                                                </a>

                                                                                <gc:confirmAjax classGC="confirmacion4#{nivel.id}" bean="#{registroController.inactivarNivel(nivel)}" mensaje="Está seguro de eliminar la clasificación?"/>
                                                                                <script>
                                                                                    function confirmar4#{nivel.id}() {
                                                                                        $(".confirmacion4#{nivel.id}").modal('show');
                                                                                    }

                                                                                </script>
                                                                            </td>
                                                                            <td style="padding-left: 10px">
                                                                                <a jsf:action="#{registroController.editarNivel(nivel)}" jsf:onclick="loadingModal()">
                                                                                    <span class="glyphicon glyphicon-pencil"/>
                                                                                    <f:ajax render="@form" onevent="closeModal" />
                                                                                </a>
                                                                            </td>
                                                                        </tr>
                                                                    </table>    
                                                                </div>             
                                                            </c:forEach>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </h:panelGroup>
                                            <table style="width: 100%">
                                                <tr>
                                                    <td style="width: 50%"></td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 10px" colspan="2">
                                                        <br/>
                                                        <span class="text-bold" style="font-size: 1.2em; color: red">Actuación o responsabilidad de Entidades del Estado</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 20px">
                                                        <span class="text-bold">Actuación o responsabilidad :</span>
                                                    </td>
                                                    <td style="padding-bottom: 20px">
                                                        <h:selectOneMenu value="#{registroController.expediente.tipoActuacionResponsabilidad}" style="width: 60%">
                                                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                            <f:selectItems value="#{listasComunesController.buscarActuacionResponsabilidad(false,false,false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                        </h:selectOneMenu>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 10px" colspan="2">
                                                        <br/>
                                                        <span class="text-bold" style="font-size: 1.2em; color: red">Grupo Vulnerables y Especiales</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 20px">
                                                        <span class="text-bold">Grupos vulnerables :</span>
                                                    </td>
                                                    <td style="padding-bottom: 20px">
                                                        <gc:selectMultiBootstrap idSelect="idSelectGrupoViolencia" idHidden="idSelect1" 
                                                                                 lista="#{listasComunesController.buscarGrupoVulnerable(false,false,false)}" value="#{registroController.expediente.tipoGrupoVulnerable}"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 20px">
                                                        <span class="text-bold">Grupos especiales :</span>
                                                    </td>
                                                    <td style="padding-bottom: 20px">
                                                        <gc:selectMultiBootstrap idSelect="idSelectGrupoEspecial" idHidden="idSelect32" 
                                                                                 lista="#{listasComunesController.buscarGrupoEspecial(false,false,false)}" value="#{registroController.expediente.tipoGrupoEspecial}"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding-bottom: 10px">
                                                        <span class="text-bold">Etiquetas:</span>
                                                    </td>
                                                    <td style="padding-bottom: 10px">                 
                                                        <div class="form-group has-feedback" style="margin: auto">
                                                            <input type="text" id="etiqueta" jsf:value="#{registroController.expediente.nombreEtiqueta}" placeholder="Ingrese Etiqueta"/>
                                                            <input type="hidden" id="idEtiqueta" jsf:value="#{registroController.expediente.idEtiqueta}" />
                                                            <a jsf:action="#{registroController.agregarEtiqueta()}">
                                                                <span class="glyphicon glyphicon-plus form-control-feedback"/>
                                                                <f:ajax render="@form" execute="@form" />
                                                            </a>
                                                        </div>

                                                        <br/>
                                                    </td>
                                                </tr>
                                            </table>

                                            <div class="row" >
                                                <c:forEach var="x" items="#{registroController.listaEtiquetasSeleccionadas}">
                                                    <div class="col-md-4 alert alert-info fade in" style="border-color: #007ACC; margin-bottom: 3px">
                                                        <table style="width: 100%">
                                                            <tr>
                                                                <td>
                                                                    <h:outputText style="font-weight: bold" value="#{x.nombreParametro}" />
                                                                </td>
                                                                <td style="text-align: right">
                                                                    <a jsf:action="#{registroController.removeEtiqueta(x)}" jsf:onclick="loadingModal()">
                                                                        <span class="glyphicon glyphicon-remove"  style="color: red"/>
                                                                        <f:ajax render="@form" onevent="closeModal" />
                                                                    </a>
                                                                </td>
                                                            </tr>
                                                        </table>    
                                                    </div>             
                                                </c:forEach>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td style="vertical-align: top;  padding-left: 2px;">
                                    <div id="idPanel2" class="panel panel-featured-top-silver">
                                        <div class="panel-body">
                                            <span class="text-resalt-primary">Información de adicional</span>
                                            <br/><br/>
                                            <span class="text-bold">Sumilla</span>
                                            <textarea rows="5" jsf:value="#{registroController.expediente.sumilla}" style="width: 100%;" placeholder="Sumilla" maxlength="1950"/>
                                            <br/>
                                            <span class="text-bold">Observaciones</span>
                                            <textarea rows="5" jsf:value="#{registroController.expediente.observacion}" style="width: 100%" placeholder="Observacion"  maxlength="1950"/>
                                            <br/><br/>
                                            <h:selectBooleanCheckbox value="#{registroController.expediente.indRelevante}" >
                                                El caso es relevante? 
                                            </h:selectBooleanCheckbox>
                                            <br/>
                                            <table style="width: 100%">
                                                <tr>
                                                    <td style="padding-top: 20px">
                                                        <label><span style="font-size: large" class="glyphicon glyphicon-paperclip" />Adjuntar archivo:</label>

                                                        <input type="file"  jsf:value="#{registroController.file5}"/>
                                                    </td>
                                                    <td>
                                                        <h:panelGroup rendered="#{registroController.expediente.ruta != null}">
                                                            <a target="_blank" href="/filesystem/#{registroController.expediente.ruta}">
                                                                <span style="font-size: large" class="glyphicon glyphicon-link" />
                                                            </a>
                                                        </h:panelGroup>

                                                    </td>
                                                </tr>
                                            </table>
                                            <br/><br/>
                                            <span class="text-resalt-primary">Información de conclusión</span>
                                            <br/><br/>
                                            <span class="text-bold">Conclusión</span>
                                            <textarea rows="5" jsf:value="#{registroController.expediente.conclusion}" style="width: 100%;" placeholder="Conclusión" maxlength="1950"/>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>

                <table style="width: 100%">       
                    <tr>
                        <td colspan="2">
                            <table style="width: 100%">
                                <tr>
                                    <td style="vertical-align: top; padding-right: 2px; text-align: left; width: 40%">
                                        <script>
                                            $(document).ready(function () {
                                                if (parseInt($("#idPanel3").height()) > parseInt($("#idPanel4").height())) {
                                                    $("#idPanel4").css("height", ($("#idPanel3").height() + 4) + "px");
                                                } else {
                                                    $("#idPanel3").css("height", ($("#idPanel4").height() + 4) + "px");
                                                }
                                                var altura = $("#idPanel1").height();
                                                $("#idPanel2").css("height", (altura + 4) + "px");
                                            });
                                        </script>

                                        <div class="panel panel-featured-top-silver" id="idPanel3">
                                            <div class="panel-body">
                                                <br/>
                                                <span class="text-resalt-primary">Recurrentes y afectados</span>
                                                <br/>
                                                <h:panelGroup id="idPanelRecurrentes">
                                                    <table style="width: 100%">
                                                        <tr>
                                                            <td style="width: 60%">
                                                                <input type="text" id="idBusquedaPersona" name="nombreActor" style="width: 100%" placeholder="Ingrese nombre/documento de la persona" jsf:value="#{registroController.persona.cadenaPersona}"/>
                                                            </td>
                                                            <td>

                                                                <a href="#" class="trigger" jsf:action="#{registroController.cargarPopoverPersona(1)}" jsf:onclick="loadingModal()">
                                                                    <span style="color: #3183B9; font-size: large;" class="glyphicon glyphicon-search"></span>
                                                                    <f:ajax render="idPanelRecurrentes" execute="idPanelRecurrentes" onevent="popove"/>
                                                                </a>
                                                                <div class="popover-markup" id="idPopover0" style="float: right"> 
                                                                    <div class="head hide ">
                                                                        <table style="width: 100%">
                                                                            <tr>
                                                                                <td>
                                                                                    <b class="text-primary">Resultado</b>
                                                                                </td>
                                                                                <td style="text-align: right">
                                                                                    <a style="cursor: pointer"  onclick="cerrarBusquedaPersona()">
                                                                                        <span class="glyphicon glyphicon-remove" style="color: red" />
                                                                                    </a>
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </div>

                                                                    <div class="content hide">

                                                                        <h:dataTable value="#{registroController.personasPopover}" var="personas" id="idDatableBusquedaPerson" class="table table-hover" style="width: 100%">

                                                                            <h:column>
                                                                                <f:facet name="header">Nombre</f:facet>
                                                                                <h:outputText value="#{personas.nombre} #{personas.apellidoPat} #{personas.apellidoMat}"/>
                                                                            </h:column>
                                                                            <h:column>
                                                                                <f:facet name="header">Número documento</f:facet>
                                                                                <h:outputText value="#{personas.numeroDocumento}"/>
                                                                            </h:column>
                                                                            <h:column>
                                                                                <a jsf:action="#{registroController.addPersona(personas)}" jsf:onclick="loadingModal()">
                                                                                    <span style="font-size: medium" class="glyphicon glyphicon-share-alt"></span>  
                                                                                    <f:ajax render=":idForm:idPanelRecurrentes" onevent="closeModal"/>
                                                                                </a>
                                                                            </h:column>
                                                                        </h:dataTable>

                                                                        <ul class="pager">
                                                                            <li>
                                                                                <a jsf:action="#{registroController.cargarPopoverPersona(registroController.nroPaginaPersona -1)}" jsf:rendered="#{!empty registroController.personasPopover}" jsf:onclick="loadingModal()">Anterior
                                                                                    <f:ajax render="idDatableBusquedaPerson" onevent="closeModal"/>
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a jsf:action="#{registroController.cargarPopoverPersona(registroController.nroPaginaPersona +1)}" jsf:rendered="#{!empty registroController.personasPopover}" jsf:onclick="loadingModal()">Siguiente
                                                                                    <f:ajax render="idDatableBusquedaPerson" onevent="closeModal"/>
                                                                                </a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>

                                                                    <style>
                                                                        .alink:hover {
                                                                            text-decoration: none;
                                                                        }
                                                                        .alink:link {
                                                                            text-decoration: none;
                                                                        }

                                                                        .alink:active {
                                                                            text-decoration: none;
                                                                        }
                                                                    </style>
                                                                    <script>
                                                                        $('body').click(function () {
                                                                            //$('.trigger').popover('destroy');
                                                                        });

                                                                        $('#idBusquedaPersona').focus(function () {
                                                                            $('.trigger').popover('destroy');
                                                                        });

                                                                        function cerrarBusquedaPersona() {
                                                                            $('.trigger').popover('destroy');
                                                                        }

                                                                        var i = 0;
                                                                        function popove(data) {
                                                                            if (data.status === 'success') {
                                                                                i++;
                                                                                $('.trigger').popover({
                                                                                    html: true,
                                                                                    placement: 'bottom',
                                                                                    tabindex: '0',
                                                                                    trigger: 'focus',
                                                                                    title: function () {
                                                                                        return $(this).parent().find('.head').html();
                                                                                    },
                                                                                    content: function () {
                                                                                        return $(this).parent().find('.content').html();
                                                                                    }
                                                                                });

                                                                                if (i === 1) {
                                                                                    $('.trigger').popover('show');
                                                                                }
                                                                                $("#loadModal").modal('hide');
                                                                                $('body').removeClass('modal-open');
                                                                                $(".modal-backdrop").removeClass("modal-backdrop");
                                                                            }
                                                                        }
                                                                    </script> 

                                                                </div>

                                                            </td>
                                                            <td style="text-align: right">
                                                                <a style="text-decoration:none" class="btn btn-primary" jsf:action="#{registroController.cargarModalActor()}" jsf:onclick="loadingModal()">
                                                                    <span class="glyphicon glyphicon-user"/>Agregar
                                                                    <f:ajax render="@form" onevent="openModalNuevaPersona"/>
                                                                </a>
                                                                <script>
                                                                    function openModalNuevaPersona(data) {
                                                                        if (data.status === 'success') {
                                                                            $("#loadModal").modal('hide');
                                                                            $('body').removeClass('modal-open');
                                                                            $(".modal-backdrop").removeClass("modal-backdrop");
                                                                            $("#idModalNuevaPersona").modal('show');
                                                                            $('.datepicker').datetimepicker({
                                                                                pickTime: false
                                                                            });
                                                                            $(".datepicker").on("changeDate", function (ev) {
                                                                                $(this).datetimepicker("hide");
                                                                            });
                                                                        }
                                                                    }
                                                                </script>
                                                                <div class="modal fade" data-backdrop="static" data-keyboard="false" id="idModalNuevaPersona" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                    <div class="modal-dialog" style="text-align: left">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <a type="button" class="close" data-dismiss="modal">
                                                                                    <span style="color:red" class="glyphicon glyphicon-remove"></span>
                                                                                </a>
                                                                                <span class="text-resalt-primary">Registro de Persona</span>
                                                                            </div>
                                                                            <div class="modal-body" style="padding:5px">
                                                                                <div class="panel-body">
                                                                                    <table style="width: 100%">
                                                                                        <tr>
                                                                                            <td style="width: 20%"><b>Tipo de documento:</b></td>
                                                                                            <td style="padding-bottom: 10px;">
                                                                                                <h:selectOneMenu value="#{registroController.persona.tipoDocumento}" style="width: 50%">
                                                                                                    <f:selectItems value="#{listasComunesController.buscarTipoDocumento(false,false,false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                                                                </h:selectOneMenu>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td style="width: 20%"><b>Número documento:</b></td>
                                                                                            <td style="padding-bottom: 10px;">
                                                                                                <input type="text" placeholder="Número documento" jsf:value="#{registroController.persona.numeroDocumento}" style="width: 50%" maxlength="50"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Nombre:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Nombre" jsf:value="#{registroController.persona.nombre}" style="width: 90%" maxlength="200"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Apellido paterno:</b></td>
                                                                                            <td style="padding-bottom: 10px;">
                                                                                                <input type="text" placeholder="Apellido Paterno" jsf:value="#{registroController.persona.apellidoPat}" style="width: 90%" maxlength="100"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Apellido Materno:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Apellido Materno" jsf:value="#{registroController.persona.apellidoMat}" style="width: 90%" maxlength="100"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Fecha de nacimiento:</b></td>
                                                                                            <td style="padding-bottom: 10px; padding-right: 200px;" >
                                                                                                <gc:calendar value="#{registroController.persona.fechaNacimiento}"/>
                                                                                            </td>

                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Sexo:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <h:selectOneRadio value="#{registroController.persona.sexo}">
                                                                                                    <f:selectItem itemLabel="Masculino" itemValue="M"/>
                                                                                                    <f:selectItem itemLabel="Femenino" itemValue="F"/>
                                                                                                </h:selectOneRadio>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Dirección:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Dirección" jsf:value="#{registroController.persona.direccion}" style="width: 90%" maxlength="300"/><br/>
                                                                                                <h:panelGroup id="idUbigeoPersona">
                                                                                                    <table style="width:90%">
                                                                                                        <tr>
                                                                                                            <td style="width:33%">
                                                                                                                <h:selectOneMenu value="#{registroController.persona.idDepartamento}">
                                                                                                                    <f:selectItem itemLabel="Departamento" itemValue="0"/>
                                                                                                                    <f:selectItems value="#{registroController.listaDepartamento}" var="y" itemLabel="#{y.value}" itemValue="#{y.label}" />
                                                                                                                    <f:ajax listener="#{registroController.comboProvincia()}" render="idUbigeoPersona" />
                                                                                                                </h:selectOneMenu>
                                                                                                            </td>
                                                                                                            <td style="width:33%">
                                                                                                                <h:selectOneMenu id="cmbProvincia1" value="#{registroController.persona.idProvincia}">
                                                                                                                    <f:selectItem itemLabel="Provincia" itemValue="0"/>
                                                                                                                    <f:selectItems value="#{registroController.listaProvincia}" var="y" itemLabel="#{y.value} #{y.label}" itemValue="#{y.id}" />
                                                                                                                    <f:ajax listener="#{registroController.comboDistrito()}" render="cmbDistrito1"/>
                                                                                                                </h:selectOneMenu>
                                                                                                            </td>
                                                                                                            <td style="width:34%">
                                                                                                                <h:selectOneMenu id="cmbDistrito1" value="#{registroController.persona.idDistrito}">
                                                                                                                    <f:selectItem itemLabel="Distrito" itemValue="0"/>
                                                                                                                    <f:selectItems value="#{registroController.listaDistrito}" var="y" itemLabel="#{y.value} #{y.label}" itemValue="#{y.id}" />
                                                                                                                </h:selectOneMenu>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </table>
                                                                                                </h:panelGroup>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Correo:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Correo electronico" jsf:value="#{registroController.persona.email}" style="width: 90%" maxlength="100"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Primer teléfono:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Telefono 1" jsf:value="#{registroController.persona.telefono1}" style="width: 90%" maxlength="50"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Segundo teléfono:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Telefono 2" jsf:value="#{registroController.persona.telefono2}" style="width: 90%" maxlength="50"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </table>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <a  class="btn btn-default" data-dismiss="modal">
                                                                                        <span class="glyphicon glyphicon-remove"/>Cerrar
                                                                                    </a>
                                                                                    <a jsf:action="#{registroController.guardarVincularListaPersona()}" class="btn btn-primary">
                                                                                        <span class="glyphicon glyphicon-floppy-disk" />Guardar
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                    <table style="width: 100%">
                                                        <tr>
                                                            <td>
                                                                <br/><br/>
                                                                <h:dataTable value="#{registroController.personasSeleccionadas}" var="per" class="table table-striped" rendered="#{registroController.personasSeleccionadas.size() > 0}" binding="#{rowIn}">
                                                                    <h:column>
                                                                        <f:facet name="header">Reserva</f:facet>
                                                                        <h:selectBooleanCheckbox id="idCheckbox" value="#{per.indicadorReserva}" />
                                                                    </h:column>
                                                                    <h:column>
                                                                        <f:facet name="header">Nombre</f:facet>
                                                                        <h:outputText value="#{per.persona.nombre} #{per.persona.apellidoPat} #{per.persona.apellidoMat}"/>
                                                                    </h:column>
                                                                    <h:column>
                                                                        <f:facet name="header">Documento</f:facet>
                                                                        <h:outputText value="#{per.persona.numeroDocumento}"/>
                                                                    </h:column>
                                                                    <h:column>
                                                                        <h:selectOneMenu value="#{per.tipo}">
                                                                            <f:selectItems value="#{listasComunesController.buscarExpedienteTipoActor(false,false,false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                                        </h:selectOneMenu>
                                                                    </h:column>
                                                                    <h:column>
                                                                        <script>
                                                                            function confirmar4#{rowIn.rowIndex+1}() {
                                                                                $(".confirmacion4#{rowIn.rowIndex+1}").modal('show');
                                                                            }
                                                                        </script>
                                                                        <gc:confirmSubmit bean="#{registroController.removePersona(per)}" classGC="confirmacion4#{rowIn.rowIndex+1}" mensaje="Esta seguro de desvincular a la Persona?" />

                                                                        <a onclick="confirmar4#{rowIn.rowIndex+1}()">
                                                                            <span style="font-size: medium; color: red" class="glyphicon glyphicon-remove"></span>
                                                                        </a>

                                                                        <a jsf:action="#{registroController.seteaPersonaExpediente(per)}" jsf:onclick="loadingModal()">
                                                                            <span style="font-size: medium" class="glyphicon glyphicon-pencil"></span>  
                                                                            <f:ajax render=":idForm:idPanelRecurrentes" execute=":idForm:idPanelRecurrentes" onevent="openModalEditPersona"/>
                                                                        </a>
                                                                    </h:column>
                                                                </h:dataTable>
                                                                <script>
                                                                    function openModalEditPersona(data) {
                                                                        if (data.status === 'success') {
                                                                            $("#loadModal").modal('hide');
                                                                            $('body').removeClass('modal-open');
                                                                            $(".modal-backdrop").removeClass("modal-backdrop");
                                                                            $("#idModalEditPersona").modal('show');
                                                                        }
                                                                    }
                                                                </script>
                                                                <div class="modal fade" data-backdrop="static" data-keyboard="false" id="idModalEditPersona" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                    <div class="modal-dialog" style="text-align: left">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <a type="button" class="close" data-dismiss="modal">
                                                                                    <span style="color:red" class="glyphicon glyphicon-remove"></span>
                                                                                </a>
                                                                                <span class="text-resalt-primary">Modificación de datos de persona</span>
                                                                            </div>
                                                                            <div class="modal-body" style="padding:5px">
                                                                                <div class="panel-body">
                                                                                    <table style="width: 100%">   
                                                                                        <tr>
                                                                                            <td colspan="2">
                                                                                                <center>
                                                                                                    <span class="text-resalt-primary">#{registroController.expedientepersonaModalEdit.persona.nombre} #{registroController.expedientepersonaModalEdit.persona.apellidoPat} #{registroController.expedientepersonaModalEdit.persona.apellidoMat}</span>
                                                                                                </center>

                                                                                                <br/>
                                                                                                <br/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Dirección:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Dirección" jsf:value="#{registroController.expedientepersonaModalEdit.direccion}" style="width: 90%" maxlength="300"/><br/>
                                                                                                <h:panelGroup id="idUbigeoPersona2">
                                                                                                    <table style="width:90%">
                                                                                                        <tr>
                                                                                                            <td style="width:33%">
                                                                                                                <h:selectOneMenu value="#{registroController.expedientepersonaModalEdit.idDepartamento}">
                                                                                                                    <f:selectItem itemLabel="Departamento" itemValue="0"/>
                                                                                                                    <f:selectItems value="#{registroController.listaDepartamento}"/>
                                                                                                                    <f:ajax listener="#{registroController.comboProvinciaId(registroController.expedientepersonaModalEdit.idDepartamento)}" render="idUbigeoPersona2" />
                                                                                                                </h:selectOneMenu>
                                                                                                            </td>
                                                                                                            <td style="width:33%">
                                                                                                                <h:selectOneMenu value="#{registroController.expedientepersonaModalEdit.idProvincia}">
                                                                                                                    <f:selectItem itemLabel="Provincia" itemValue="0"/>
                                                                                                                    <f:selectItems value="#{registroController.listaProvincia}"  />
                                                                                                                    <f:ajax listener="#{registroController.comboDistritoId(registroController.expedientepersonaModalEdit.idProvincia)}" render="cmbDistrito2"/>
                                                                                                                </h:selectOneMenu>
                                                                                                            </td>
                                                                                                            <td style="width:34%">
                                                                                                                <h:selectOneMenu id="cmbDistrito2" value="#{registroController.expedientepersonaModalEdit.idDistrito}">
                                                                                                                    <f:selectItem itemLabel="Distrito" itemValue="0"/>
                                                                                                                    <f:selectItems value="#{registroController.listaDistrito}" />
                                                                                                                </h:selectOneMenu>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </table>
                                                                                                </h:panelGroup>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Correo:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Correo electronico" jsf:value="#{registroController.expedientepersonaModalEdit.email}" style="width: 90%" maxlength="100"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td><b>Telefono:</b></td>
                                                                                            <td style="padding-bottom: 10px">
                                                                                                <input type="text" placeholder="Telefono 1" jsf:value="#{registroController.expedientepersonaModalEdit.telefono1}" style="width: 90%" maxlength="50"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </table>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <a  class="btn btn-default" data-dismiss="modal">
                                                                                        <span class="glyphicon glyphicon-remove"/>Cerrar
                                                                                    </a>
                                                                                    <a jsf:action="#{registroController.editaPersonaExpediente()}" class="btn btn-primary">
                                                                                        <span class="glyphicon glyphicon-floppy-disk" />Guardar
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </h:panelGroup>
                                            </div>
                                        </div>
                                    </td>
                                    <td style="vertical-align: top; padding-left: 2px">
                                        <div class="panel panel-featured-top-silver" id="idPanel4">
                                            <div class="panel-body">
                                                <br/>
                                                <h:panelGroup id="idPanelEntidadesQue">
                                                    <table style="width: 100%">
                                                        <tr>
                                                            <td style="width: 85%">
                                                                <table style="width: 100%">
                                                                    <tr>
                                                                        <td>
                                                                            <td>
                                                                                <span class="text-resalt-primary">Región</span>
                                                                                <h:selectOneMenu value="#{registroController.entidad.idDepartamento}">
                                                                                    <f:selectItem itemValue="#{registroController.usuarioSession.idDepartamento}" itemLabel="#{registroController.usuarioSession.nombreDepartamento}" />
                                                                                    <f:selectItem itemValue="0" itemLabel="Todas las regiones" />
                                                                                </h:selectOneMenu>
                                                                            </td>
                                                                            <td>
                                                                                <span class="text-resalt-primary">Tipo</span>
                                                                                <h:selectOneMenu value="#{registroController.entidad.tipo}">
                                                                                    <f:selectItem itemValue="0" itemLabel="Seleccione" />
                                                                                    <f:selectItem itemValue="1" itemLabel="Centro médico" />
                                                                                    <f:selectItem itemValue="2" itemLabel="Colegio" />
                                                                                    <f:selectItem itemValue="3" itemLabel="Comisaría" />
                                                                                </h:selectOneMenu>
                                                                            </td>
                                                                        </td>
                                                                        <td>
                                                                            <span class="text-resalt-primary">Entidad</span>
                                                                            <input type="text" id="idBusquedaEntidad" style="width: 100%" placeholder="Ingrese nombre de la Entidad" jsf:value="#{registroController.entidad.nombre}"/>
                                                                        </td>
                                                                    </tr>
                                                                </table>

                                                            </td>
                                                            <td style="vertical-align: bottom">
                                                                <a style="vertical-align: bottom" href="#" class="trigger1" jsf:action="#{registroController.cargarPopoverEntidad(1)}" jsf:onclick="loadingModal()">
                                                                    <span style="color: #3183B9; font-size: large;" class="glyphicon glyphicon-search"></span>
                                                                    <f:ajax render="idPanelEntidadesQue" execute="idPanelEntidadesQue" onevent="popove1"/>
                                                                </a>
                                                                <div class="popover-markup" style="float: right"> 
                                                                    <div class="head hide ">
                                                                        <table style="width: 100%">
                                                                            <tr>
                                                                                <td>
                                                                                    <b class="text-primary">Resultado</b>
                                                                                </td>
                                                                                <td style="text-align: right">
                                                                                    <a style="cursor: pointer"  onclick="cerrarBusquedaEntidad()">
                                                                                        <span class="glyphicon glyphicon-remove" style="color: red" />
                                                                                    </a>
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </div>

                                                                    <h:panelGroup id="idPanel1">
                                                                        <div class="content hide">

                                                                            <h:dataTable value="#{registroController.entidadPopover}" id="idDatableBusquedaEntida" var="entidades" class="table table-hover">
                                                                                <h:column>
                                                                                    <f:facet name="header">Nombre</f:facet>
                                                                                    <h:outputText value="#{entidades.nombre}"/>
                                                                                </h:column>
                                                                                <h:column>
                                                                                    <f:facet name="header">Tipo</f:facet>
                                                                                    <h:outputText value="#{entidades.tipoDetalle}"/>
                                                                                </h:column>
                                                                                <h:column>
                                                                                    <f:facet name="header">Región</f:facet>
                                                                                    <h:outputText value="#{entidades.nombreDepartamento}"/>
                                                                                </h:column>
                                                                                <h:column>
                                                                                    <a jsf:action="#{registroController.addEntidad(entidades)}" jsf:onclick="loadingModal()">
                                                                                        <span style="font-size: medium" class="glyphicon glyphicon-share-alt"></span>  
                                                                                        <f:ajax render=":idForm:idPanelEntidadesQue" onevent="closeModal"/>
                                                                                    </a>
                                                                                </h:column>
                                                                            </h:dataTable>
                                                                            <ul class="pager">
                                                                                <li>
                                                                                    <a jsf:action="#{registroController.cargarPopoverEntidad(registroController.nroPaginaPersona -1)}" jsf:rendered="#{!empty registroController.entidadPopover}" jsf:onclick="loadingModal()">Anterior
                                                                                        <f:ajax render="idDatableBusquedaEntida" onevent="closeModal"/>
                                                                                    </a>
                                                                                </li>
                                                                                <li>
                                                                                    <a jsf:action="#{registroController.cargarPopoverEntidad(registroController.nroPaginaPersona +1)}" jsf:rendered="#{!empty registroController.entidadPopover}" jsf:onclick="loadingModal()">Siguiente
                                                                                        <f:ajax render="idDatableBusquedaEntida" onevent="closeModal"/>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                        </div>

                                                                        <style>
                                                                            .alink:hover {
                                                                                text-decoration: none;
                                                                            }
                                                                            .alink:link {
                                                                                text-decoration: none;
                                                                            }

                                                                            .alink:active {
                                                                                text-decoration: none;
                                                                            }
                                                                        </style>
                                                                        <script>
                                                                            $('#idBusquedaEntidad').focus(function () {
                                                                                $('.trigger1').popover('destroy');
                                                                            });

                                                                            function cerrarBusquedaEntidad() {
                                                                                $('.trigger1').popover('destroy');
                                                                            }

                                                                            var i = 0;
                                                                            function popove1(data) {
                                                                                if (data.status === 'success') {
                                                                                    i++;
                                                                                    $('.trigger1').popover({
                                                                                        html: true,
                                                                                        placement: 'bottom',
                                                                                        tabindex: '0',
                                                                                        trigger: 'focus',
                                                                                        title: function () {
                                                                                            return $(this).parent().find('.head').html();
                                                                                        },
                                                                                        content: function () {
                                                                                            return $(this).parent().find('.content').html();
                                                                                        }
                                                                                    });

                                                                                    if (i === 1) {
                                                                                        $('.trigger1').popover('show');
                                                                                    }
                                                                                    $("#loadModal").modal('hide');
                                                                                    $('body').removeClass('modal-open');
                                                                                    $(".modal-backdrop").removeClass("modal-backdrop");
                                                                                }
                                                                            }
                                                                        </script> 
                                                                    </h:panelGroup>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2">
                                                                <br/><br/>
                                                                <h:dataTable value="#{registroController.entidadSeleccionadas}" var="entidad" class="table table-striped" rendered="#{registroController.entidadSeleccionadas.size() > 0}">
                                                                    <h:column>
                                                                        <f:facet name="header">Nombre</f:facet>
                                                                        <h:outputText value="#{entidad.entidad.nombre}"/>
                                                                    </h:column>
                                                                    <h:column>
                                                                        <f:facet name="header">Func. quejado</f:facet>
                                                                        <input type="text" jsf:value="#{entidad.nombreCompleto}" placeholder="Nombre" maxlength="300"/> 
                                                                    </h:column>
                                                                    <h:column>
                                                                        <f:facet name="header">Cargo</f:facet>
                                                                        <input type="text" jsf:value="#{entidad.cargo}" placeholder="Cargo" maxlength="200"/>
                                                                    </h:column>
                                                                    <h:column>
                                                                        <script>
                                                                            function confirmar3#{entidad.entidad.id}() {
                                                                                $(".confirmacion3#{entidad.entidad.id}").modal('show');
                                                                            }
                                                                        </script>
                                                                        <gc:confirmSubmit bean="#{registroController.removeEntidad(entidad)}" classGC="confirmacion3#{entidad.entidad.id}" mensaje="Esta seguro de desvincular la Entidad?" />
                                                                        <a onclick="confirmar3#{entidad.entidad.id}()">
                                                                            <span style="font-size: large; color: red" class="glyphicon glyphicon-remove"></span>
                                                                        </a>
                                                                    </h:column>
                                                                </h:dataTable>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </h:panelGroup>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div class="panel panel-featured-top-warning" style="height: 100px">
                                <div class="panel-body">
                                    <span class="text-resalt-primary">Responsables del caso</span>
                                    <span class="text-resalt-primary"><b>#{registroController.usuarioSession.nombre} #{registroController.usuarioSession.apellidoPaterno} #{registroController.usuarioSession.apellidoMaterno} - #{registroController.usuarioSession.cargo}</b></span>
                                </div>
                            </div>
                        </td>                    
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: center">

                        </td>
                    </tr>
                </table>

            </h:form>
        </ui:define>
    </ui:composition>
</html>            
