<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:gc="http://xmlns.jcp.org/jsf/composite/gc">

    <ui:composition template="../template/template.xhtml">

        <ui:define name="content">
            <h:form id="idForm" class="form-horizontal">
                <h:messages />
                <script>
                    function confirmar2() {
                        $(".confirmacion2").modal('show');
                    }
                    function confirmar3() {
                        $(".confirmacion3").modal('show');
                    }
                </script>
                
                <table style="width: 100%">
                    <tr>
                        <td colspan="2">
                            <div class="panel panel-featured-top-primary">
                                <div class="panel-body" >
                                    <table style="width: 100%">
                                        <tr>
                                            <td colspan="2">
                                                <span style="font-size: 2em" class="text-resalt-primary">Expediente: #{registroController.expediente.numero}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <h:outputText rendered="#{registroController.etapaEstado.verEtapa != 0 and registroController.etapaEstado.verEtapa != null}" value="Estado: #{registroController.etapaEstado.ultimaEtapa}" class="text-primary" style="font-size: 1.5em"/>
                                            </td>
                                        </tr>    
                                        <tr>
                                            <td colspan="2">
                                                <br/>
                                                <table style="width: 90%">
                                                    <tr>
                                                        <td style="width: 10%">
                                                            <span class="text-primary" style="font-size: 1.5em">Etapa:</span>
                                                        </td>
                                                        <td>
                                                            <div class="btn-group btn-group-justified" role="group" style="width: 50%">
                                                                <div class="btn-group" role="group">
                                                                    <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(1)}" class="btn #{registroController.etapaEstado.verEtapa == 1? 'btn-warning' : 'btn-default'}">
                                                                        <c:choose>
                                                                            <c:when test="${registroController.etapaEstado.verEtapa == 1}">
                                                                                <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Calificación
                                                                            </c:when>
                                                                            <c:otherwise>
                                                                                Calificación
                                                                            </c:otherwise>
                                                                        </c:choose>

                                                                    </a>
                                                                </div>
                                                                <div class="btn-group" role="group">
                                                                    <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(2)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 2? 'btn-warning' : 'btn-default'}">
                                                                        <c:choose>
                                                                            <c:when test="${registroController.etapaEstado.verEtapa == 2}">
                                                                                <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Investigación
                                                                            </c:when>
                                                                            <c:otherwise>
                                                                                Investigación
                                                                            </c:otherwise>
                                                                        </c:choose>
                                                                    </a>
                                                                </div>
                                                                <div class="btn-group" role="group">
                                                                    <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(3)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 3? 'btn-warning' : 'btn-default'}">
                                                                        <c:choose>
                                                                            <c:when test="${registroController.etapaEstado.verEtapa == 3}">
                                                                                <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Persuación
                                                                            </c:when>
                                                                            <c:otherwise>
                                                                                Persuación
                                                                            </c:otherwise>
                                                                        </c:choose>
                                                                    </a>
                                                                </div>
                                                                <div class="btn-group" role="group">
                                                                    <a style="cursor: auto" onclick="return false" jsf:action="#{registroController.cargarExpedienteEtapa(1)}" type="button" class="btn #{registroController.etapaEstado.verEtapa == 4? 'btn-warning' : 'btn-default'}">
                                                                        <c:choose>
                                                                            <c:when test="${registroController.etapaEstado.verEtapa == 4}">
                                                                                <span class="glyphicon glyphicon-paperclip" style="font-size: large; color: black"/>&#160;&#160;&#160;&#160;Seguimiento
                                                                            </c:when>
                                                                            <c:otherwise>
                                                                                Seguimiento
                                                                            </c:otherwise>
                                                                        </c:choose>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                            <table style="width: 90%">
                                                <tr>
                                                    <td style="width: 25%">
                                                        <h:outputText rendered="#{registroController.etapaEstado.verEtapa != 0 and registroController.etapaEstado.verEtapa != null}" value="Asignar estado:" class="text-primary" style="font-size: 1.5em"/>
                                                    </td>
                                                    <td>
                                                        <div class="panel-body">
                                                            <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 1}"  value="#{registroController.expediente.estadoCalificacion}">
                                                                <f:selectItems value="#{registroController.listaEstadoCalificacion}"  />
                                                            </h:selectOneRadio>

                                                            <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 2}"  value="#{registroController.expediente.estadoInvestigacion}">
                                                                <f:selectItems value="#{registroController.listaEstadoInvestigacion}"  />
                                                            </h:selectOneRadio>

                                                            <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 3}"  value="#{registroController.expediente.estadoPersuacion}">
                                                                <f:selectItems value="#{registroController.listaEstadoPersuacion}"  />
                                                            </h:selectOneRadio>

                                                            <h:selectOneRadio rendered="#{registroController.etapaEstado.verEtapa == 4}"  value="#{registroController.expediente.estadoSeguimiento}">
                                                                <f:selectItems value="#{registroController.listaEstadoSeguimiento}"  />
                                                            </h:selectOneRadio>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>

                                                        <input type="hidden" id="idTipoClasificacion" jsf:value="#{registroController.expediente.tipoClasificion}" />
                                                        <span style="font-size: 2.5em" class="text-resalt-primary">Atención de Casos</span><br/>
                                                        <span id="idTextTipoClasificacion" class="text-resalt-comun" style="font-weight: bold;font-size: 1.5em">SELECCIONE</span>
                                                        <a href="#" class="trigger2">
                                                            <span style="color:#3183b9;font-size:large;vertical-align: top" class="glyphicon glyphicon-chevron-down trigger2"></span>
                                                        </a>
                                                        <div class="popover-markup" style="float:right">
                                                            <div class="head hide"><b class="text-primary">Seleccione</b></div>
                                                            <div class="content hide">
                                                                <div style="width:100%">
                                                                    <c:forEach var="x" items="#{listasComunesController.buscarExpedienteTipoClasificacion(false,false,false)}">
                                                                        <a class="alink" onclick="asignarTipo('${x.valorParametro}')">
                                                                            <div class="alert fade in alert-danger" role="alert" style="padding-bottom:5px;padding-top:5px;margin-bottom:3px">
                                                                                <strong>
                                                                                    <h:outputText value="${x.nombreParametro}" class="cTipoRegistro" style="cursor:pointer"/>
                                                                                </strong>
                                                                            </div>
                                                                        </a>
                                                                    </c:forEach>


                                                                </div>
                                                            </div>
                                                        </div>
                                                        <style>.alink:hover{text-decoration:none}.alink:link{text-decoration:none}.alink:active{text-decoration:none}</style>
                                                        <script>$('.trigger2').popover({html: true, placement: 'bottom', tabindex: '0', trigger: 'focus', title: function () {
                                                                    return $(this).parent().find('.head').html();
                                                                }, content: function () {
                                                                    return $(this).parent().find('.content').html();
                                                                }});
                                                            function asignarTipo(tipo) {
                                                                $("#idTipoClasificacion").val(tipo);
                                                                $("#idTextTipoClasificacion").css("color", "#3071A9");
                                                                if (tipo === "01") {
                                                                    $("#idTextTipoClasificacion").text("QUEJA");

                                                                }
                                                                if (tipo === "02") {
                                                                    $("#idTextTipoClasificacion").text("CONSULTA");

                                                                }
                                                                if (tipo === "03") {
                                                                    $("#idTextTipoClasificacion").text("PETITORIO");

                                                                }
                                                                if (tipo === "04") {
                                                                    $("#idTextTipoClasificacion").text("SIN CLASIFICACION");

                                                                }
                                                            }
                                                            if ($("#idTipoRegistro").val() !== "") {
                                                                if ($("#idTipoClasificacion").val() === "01") {
                                                                    $("#idTextTipoClasificacion").text("QUEJA");

                                                                }
                                                                if ($("#idTipoClasificacion").val() === "02") {
                                                                    $("#idTextTipoClasificacion").text("CONSULTA");

                                                                }
                                                                if ($("#idTipoClasificacion").val() === "03") {
                                                                    $("#idTextTipoClasificacion").text("PETITORIO");

                                                                }
                                                                if ($("#idTipoClasificacion").val() === "04") {
                                                                    $("#idTextTipoClasificacion").text("SIN CLASIFICACION");

                                                                }
                                                                $("#idTextTipoClasificacion").css("color", "#3071A9");
                                                            }
                                                            $(document).ready(function () {
                                                                if ($("#idTipoRegistro").val() !== "") {
                                                                    if ($("#idTipoClasificacion").val() === "01") {
                                                                        $("#idTextTipoClasificacion").text("QUEJA");

                                                                    }
                                                                    if ($("#idTipoClasificacion").val() === "02") {
                                                                        $("#idTextTipoClasificacion").text("CONSULTA");

                                                                    }
                                                                    if ($("#idTipoClasificacion").val() === "03") {
                                                                        $("#idTextTipoClasificacion").text("PETITORIO");

                                                                    }
                                                                    if ($("#idTipoClasificacion").val() === "04") {
                                                                        $("#idTextTipoClasificacion").text("SIN CLASIFICACION");

                                                                    }
                                                                    $("#idTextTipoClasificacion").css("color", "#3071A9");
                                                                }
                                                            });</script>
                                                    </td>
                                                    
                                                </tr>
                                            </table>
                                                </td>
                                        </tr>
                                    </table>

                                </div>
                            </div>
                        </td>
                    </tr>
                </table>

                <ul class="nav nav-tabs" style="float: right">
  <li role="presentation" ><a style="cursor: pointer" jsf:rendered="true" jsf:action="expedienteNuevo">Expediente</a></li>
  <li role="presentation" class="active"><a style="cursor: pointer" jsf:action="#{registroController.cargarExpedienteGestionLista()}">Gestiones</a></li>
</ul>
                
                <div class="panel panel-default">
                    <div class="panel-heading">Listado de Gestiones</div>
                    <div class="panel-body">
                        
                        <table style="width:100%">
                                <tr>
                                    <td colspan="4">
                                            <a class="btn btn-primary" jsf:rendered="#{registroController.etapaEstado.idEtapa == registroController.etapaEstado.verEtapa}" jsf:action="#{registroController.cargarExpedienteGestion()}">
                                                <span class="glyphicon glyphicon-list-alt" />Nueva Gestión
                                            </a>
                                    </td>
                            </tr>
                            <tr>
                                <td>
                                    <span class="glyphicon glyphicon-folder-open" style="font-size:medium"></span>
                                    <span class="text-resalt-comun">Calificación</span>
                                    <a id="addCalificacion">
                                        <span id="spanAddCalificacion" class="glyphicon glyphicon-plus" style="font-size:medium;cursor:pointer"></span>
                                    </a>
                                </td>
                                <td>
                                    <span class="glyphicon glyphicon-folder-open" style="font-size:medium"></span>
                                    <span class="text-resalt-comun">Investigación</span>
                                    <a id="addInvestigacion">
                                        <span id="spanAddInvestigacion" class="glyphicon glyphicon-plus" style="font-size:medium;cursor:pointer"></span>
                                    </a>
                                </td>
                                <td>
                                    <span class="glyphicon glyphicon-folder-open" style="font-size:medium"></span>
                                    <span class="text-resalt-comun">Persuación</span>
                                    <a id="addInvestigacion">
                                        <span id="spanAddInvestigacion" class="glyphicon glyphicon-plus" style="font-size:medium;cursor:pointer"></span>
                                    </a>
                                </td>
                                <td>
                                    <span class="glyphicon glyphicon-folder-open" style="font-size:medium"></span>
                                    <span class="text-resalt-comun">Seguimiento</span>
                                    <a id="addInvestigacion">
                                        <span id="spanAddInvestigacion" class="glyphicon glyphicon-plus" style="font-size:medium;cursor:pointer"></span>
                                    </a>
                                </td>
                            </tr>
                        </table>
                            
                     <div id="idPanelBodyCalificacion" class="panel panel-default">
                            <div  class="panel-body">
                                <h:dataTable value="#{registroController.listaExpedientesCalificacion}" var="calificacion" binding="#{rowx1}">
                                    <h:column>
                                            <f:facet name="header">N°</f:facet>
                                            <h:outputText value="#{rowx1.rowIndex+1}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Nombre</f:facet>
                                            <h:outputText value="#{calificacion.nombre}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Acción</f:facet>
                                            <h:outputText value="#{calificacion.nombreParametroTipo}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Fecha</f:facet>
                                            <h:outputText value="#{calificacion.fecha}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Lima" />
                                            </h:outputText>
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Editar</f:facet>
                                            <a jsf:action="#{registroController.setExpedienteGestion(calificacion)}">
                                                <span class="glyphicon glyphicon-pencil" />
                                            </a>
                                        </h:column>
                                </h:dataTable>
                        </div>
                       
                        
                        </div>
                        
                        
                        <div id="idPanelBodyInvestigacion" class="panel panel-default">
                            <div  class="panel-body">
                                <h:dataTable value="#{registroController.listaExpedientesInvestigacion}" var="investigacion" binding="#{rowx2}">
                                    <h:column>
                                            <f:facet name="header">N°</f:facet>
                                            <h:outputText value="#{rowx2.rowIndex+1}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Nombre</f:facet>
                                            <h:outputText value="#{investigacion.nombre}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Acción</f:facet>
                                            <h:outputText value="#{investigacion.nombreParametroTipo}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Fecha</f:facet>
                                            <h:outputText value="#{investigacion.fecha}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Lima" />
                                            </h:outputText>
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Editar</f:facet>
                                            <a jsf:action="#{registroController.setExpedienteGestion(investigacion)}">
                                                <span class="glyphicon glyphicon-pencil" />
                                            </a>
                                        </h:column>
                                </h:dataTable>
                        </div>
                       
                        
                        </div>
                        
                        <div id="idPanelBodyPersuacion" class="panel panel-default">
                            <div  class="panel-body">
                                <h:dataTable value="#{registroController.listaExpedientesPersuacion}" var="persuacion" binding="#{rowx3}">
                                    <h:column>
                                            <f:facet name="header">N°</f:facet>
                                            <h:outputText value="#{rowx3.rowIndex+1}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Nombre</f:facet>
                                            <h:outputText value="#{persuacion.nombre}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Acción</f:facet>
                                            <h:outputText value="#{persuacion.nombreParametroTipo}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Fecha</f:facet>
                                            <h:outputText value="#{persuacion.fecha}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Lima" />
                                            </h:outputText>
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Editar</f:facet>
                                            <a jsf:action="#{registroController.setExpedienteGestion(persuacion)}">
                                                <span class="glyphicon glyphicon-pencil" />
                                            </a>
                                        </h:column>
                                </h:dataTable>
                        </div>
                       
                        
                        </div>
                        
                        <div id="idPanelBodySeguimiento" class="panel panel-default">
                            <div  class="panel-body">
                                <h:dataTable value="#{registroController.listaExpedientesSeguimiento}" var="seguimiento" binding="#{rowx4}">
                                    <h:column>
                                            <f:facet name="header">N°</f:facet>
                                            <h:outputText value="#{rowx4.rowIndex+1}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Nombre</f:facet>
                                            <h:outputText value="#{seguimiento.nombre}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Acción</f:facet>
                                            <h:outputText value="#{seguimiento.nombreParametroTipo}" />
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Fecha</f:facet>
                                            <h:outputText value="#{seguimiento.fecha}">
                                                <f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Lima" />
                                            </h:outputText>
                                        </h:column>
                                        
                                        <h:column>
                                            <f:facet name="header">Editar</f:facet>
                                            <a jsf:action="#{registroController.setExpedienteGestion(seguimiento)}">
                                                <span class="glyphicon glyphicon-pencil" />
                                            </a>
                                        </h:column>
                                </h:dataTable>
                        </div>
                       
                        
                        </div>
                       
                     
                        <script>
                    $("#idPanelBodyCalificacion").hide();
                    
                    $("#addCalificacion").click(function () {
                        if ($("#spanAddCalificacion").attr('class') === "glyphicon glyphicon-plus")
                        {
                            $("#idPanelBodyCalificacion").slideDown(400).delay(800);
                            $("#spanAddCalificacion").removeClass("glyphicon-plus").addClass("glyphicon-minus");
                        }
                        else
                        {
                            $("#idPanelBodyCalificacion").slideUp(300).delay(800);
                            $("#spanAddCalificacion").removeClass("glyphicon-minus").addClass("glyphicon-plus");
                        }
                    });
                    
                    
                    $("#idPanelBodyInvestigacion").hide();
                    
                    $("#addInvestigacion").click(function () {
                        if ($("#spanAddInvestigacion").attr('class') === "glyphicon glyphicon-plus")
                        {
                            $("#idPanelBodyInvestigacion").slideDown(400).delay(800);
                            $("#spanAddInvestigacion").removeClass("glyphicon-plus").addClass("glyphicon-minus");
                        }
                        else
                        {
                            $("#idPanelBodyInvestigacion").slideUp(300).delay(800);
                            $("#spanAddInvestigacion").removeClass("glyphicon-minus").addClass("glyphicon-plus");
                        }
                    });
                    
                    
                    $("#idPanelBodyPersuacion").hide();
                    
                    $("#addPersuacion").click(function () {
                        if ($("#spanAddPersuacion").attr('class') === "glyphicon glyphicon-plus")
                        {
                            $("#idPanelBodyPersuacion").slideDown(400).delay(800);
                            $("#spanAddPersuacion").removeClass("glyphicon-plus").addClass("glyphicon-minus");
                        }
                        else
                        {
                            $("#idPanelBodyPersuacion").slideUp(300).delay(800);
                            $("#spanAddPersuacion").removeClass("glyphicon-minus").addClass("glyphicon-plus");
                        }
                    });
                    
                    
                    $("#idPanelBodySeguimiento").hide();
                    
                    $("#addSeguimiento").click(function () {
                        if ($("#spanAddSeguimiento").attr('class') === "glyphicon glyphicon-plus")
                        {
                            $("#idPanelBodySeguimiento").slideDown(400).delay(800);
                            $("#spanAddSeguimiento").removeClass("glyphicon-plus").addClass("glyphicon-minus");
                        }
                        else
                        {
                            $("#idPanelBodySeguimiento").slideUp(300).delay(800);
                            $("#spanAddSeguimiento").removeClass("glyphicon-minus").addClass("glyphicon-plus");
                        }
                    });
                        </script>
                    </div>
                </div>
                

                
                
                 
            </h:form>
        </ui:define>
    </ui:composition>
</html>            
